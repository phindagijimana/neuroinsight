# v1.1.4 Build Verification Checklist

**Purpose**: Verify that v1.1.4 build has BOTH fixes before releasing to users

---

## ‚úÖ Pre-Build Verification (Code in GitHub)

### Fix #1: main.js Path (VERIFIED ‚úÖ)

**Command**:
```bash
git show desktop-v1.1.4:desktop_alone/electron-app/src/main.js | grep -A3 "const frontendPath"
```

**Expected Output**:
```javascript
const frontendPath = path.join(__dirname, 'frontend', 'index.html');
```

**Status**: ‚úÖ **CORRECT** - No "src/" in path!

---

### Fix #2: package.json Frontend Bundling (VERIFIED ‚úÖ)

**Command**:
```bash
git show desktop-v1.1.4:desktop_alone/electron-app/package.json | grep -A12 '"files":'
```

**Expected Output**:
```json
"files": [
  "src/**/*",
  "assets/**/*",
  {
    "from": "../frontend",
    "to": "frontend",
    "filter": ["**/*"]
  },
  "!**/*.map",
  "!**/.DS_Store"
],
```

**Status**: ‚úÖ **CORRECT** - Uses object syntax with from/to/filter!

---

## ‚úÖ Post-Build Verification (After GitHub Actions Completes)

### Step 1: Check Build Status

**Go to**: https://github.com/phindagijimana/neuroinsight/actions

**Look for**: "Desktop Build v15" with tag "desktop-v1.1.4"

**Verify**:
- [ ] Build Linux AppImage - ‚úÖ Success
- [ ] Build Windows Installer - ‚úÖ Success
- [ ] Build macOS DMG - ‚úÖ Success
- [ ] Create GitHub Release - ‚úÖ Success (or skipped due to file size)

---

### Step 2: Download and Extract

```bash
# Download from GitHub Actions artifacts
# Extract
cd ~/Downloads
unzip neuroinsight-mac.zip

# Should see:
# - NeuroInsight-1.0.0.dmg (Intel)
# - NeuroInsight-1.0.0-arm64.dmg (Apple Silicon)
# - checksums-mac.txt
```

---

### Step 3: Verify Frontend is Bundled (Before Installing)

```bash
# Mount DMG
hdiutil attach NeuroInsight-1.0.0-arm64.dmg

# Check app contents
cd /Volumes/NeuroInsight\ 1.0.0/NeuroInsight.app/Contents/Resources

# Verify frontend in app.asar
npx asar list app.asar | grep "frontend/index.html"
```

**Expected Output**:
```
/frontend/index.html  ‚úÖ
```

**If empty**: ‚ùå Frontend NOT bundled - BUILD FAILED

---

### Step 4: Extract and Check main.js

```bash
# Extract app.asar
cd /tmp
npx asar extract /Volumes/NeuroInsight\ 1.0.0/NeuroInsight.app/Contents/Resources/app.asar neuroinsight-v1.1.4-check

# Check main.js path
grep "const frontendPath" neuroinsight-v1.1.4-check/src/main.js
```

**Expected Output**:
```javascript
const frontendPath = path.join(__dirname, 'frontend', 'index.html');
```

**NO "src/"!** ‚úÖ

**If has "src/"**: ‚ùå Wrong main.js - BUILD FAILED

**Cleanup**:
```bash
rm -rf neuroinsight-v1.1.4-check
hdiutil detach /Volumes/NeuroInsight\ 1.0.0
```

---

### Step 5: Install and Test

```bash
# Delete old app
rm -rf /Applications/NeuroInsight.app

# Install new one
open NeuroInsight-1.0.0-arm64.dmg
# Drag to Applications

# Remove quarantine
sudo xattr -cr /Applications/NeuroInsight.app

# Run with logging
/Applications/NeuroInsight.app/Contents/MacOS/NeuroInsight 2>&1 | tee ~/v1.1.4-final-test.log
```

**Watch for**:
```
‚úÖ Backend is ready!
‚úÖ Loading frontend from: .../frontend/index.html  (NO "src/")
‚úÖ Frontend loaded successfully
‚úÖ Application window shown
```

---

### Step 6: Verify No Dark Window

**Visual Check**:
- [ ] Splash screen appears
- [ ] Main window opens
- [ ] UI is visible (NOT dark/blank)
- [ ] Can see navigation, buttons, forms
- [ ] Can interact with interface

---

### Step 7: Check Final Log

```bash
cat ~/v1.1.4-final-test.log | grep -E "(Loading frontend|Failed to load|Frontend loaded)"
```

**Expected**:
```
‚úÖ Loading frontend from: .../frontend/index.html
‚úÖ Frontend loaded successfully
```

**NOT**:
```
‚ùå Loading frontend from: .../src/frontend/index.html
‚ùå Failed to load frontend
```

---

## üö® If Build Verification Fails

### If Frontend NOT in app.asar:

**Problem**: package.json fix didn't apply  
**Solution**: 
1. Check build logs on GitHub Actions
2. Verify package.json in repo
3. Create v1.1.5 with fix confirmed

### If Path Still Has "src/":

**Problem**: main.js fix didn't apply  
**Solution**:
1. Check build logs on GitHub Actions
2. Verify main.js in repo
3. Create v1.1.5 with fix confirmed

### If Both Fixes Look Good But Still Dark Window:

**Problem**: Something else is wrong  
**Collect**:
1. Full log: `cat ~/v1.1.4-final-test.log`
2. Backend logs: Check for backend errors
3. System logs: `log show --predicate 'process == "NeuroInsight"' --last 1m`

---

## ‚úÖ Success Criteria

v1.1.4 is GOOD if:

1. ‚úÖ Frontend in app.asar: `/frontend/index.html`
2. ‚úÖ main.js path correct: `path.join(__dirname, 'frontend', 'index.html')`
3. ‚úÖ App runs: Backend starts
4. ‚úÖ Frontend loads: "Frontend loaded successfully"
5. ‚úÖ NO dark window: Full UI visible
6. ‚úÖ Can interact: Upload button, navigation work

---

## üìä Comparison Table

| Check | v1.1.3 (Current) | v1.1.4 (Expected) |
|-------|------------------|-------------------|
| Frontend bundled? | ‚úÖ Yes | ‚úÖ Yes |
| main.js path | ‚ùå `src/frontend/` | ‚úÖ `frontend/` |
| Frontend loads? | ‚ùå ERR_FILE_NOT_FOUND | ‚úÖ Should load |
| Dark window? | ‚ùå Yes | ‚úÖ No (expected) |

---

## üéØ Quick Verification Commands

**After downloading v1.1.4**:

```bash
# 1. Check frontend bundled
hdiutil attach NeuroInsight-1.0.0-arm64.dmg
cd /Volumes/NeuroInsight\ 1.0.0/NeuroInsight.app/Contents/Resources
npx asar list app.asar | grep "frontend/index.html"
# Expected: /frontend/index.html

# 2. Check main.js (quick)
cd /tmp
npx asar extract /Volumes/NeuroInsight\ 1.0.0/NeuroInsight.app/Contents/Resources/app.asar v114check
grep -n "src.*frontend" v114check/src/main.js
# Expected: NO MATCHES (no "src" before "frontend")

# 3. Install and test
rm -rf /Applications/NeuroInsight.app
# Drag from DMG
sudo xattr -cr /Applications/NeuroInsight.app
/Applications/NeuroInsight.app/Contents/MacOS/NeuroInsight 2>&1 | tee ~/v114-test.log

# 4. Check result
grep "Loading frontend" ~/v114-test.log
# Expected: .../frontend/index.html (NO "src/")

grep "Frontend loaded successfully" ~/v114-test.log
# Expected: Should have this line
```

---

## üîÑ Re-verification (If You Want to Double-Check)

Run these on the HPC to verify the tag before build completes:

```bash
cd /mnt/nfs/home/urmc-sh.rochester.edu/pndagiji/hippo

# Verify tag exists
git tag | grep desktop-v1.1.4

# Check commit
git log -1 desktop-v1.1.4

# Verify main.js fix
git show desktop-v1.1.4:desktop_alone/electron-app/src/main.js | grep "const frontendPath"

# Verify package.json fix
git show desktop-v1.1.4:desktop_alone/electron-app/package.json | grep -A8 '"files":'
```

---

## ‚è∞ Monitoring Build Progress

**Check build status**:
```
https://github.com/phindagijimana/neuroinsight/actions
```

**Look for**:
- Workflow: "Desktop Build v15 - Fixed (Frontend Bundled)"
- Tag: desktop-v1.1.4
- Status: Should show progress for Linux, Windows, macOS

**Build times**:
- Linux: ~20 minutes
- Windows: ~30 minutes
- macOS: ~30 minutes

**Total**: ~30-60 minutes (runs in parallel)

---

## üìù What to Report Back

After testing v1.1.4, report:

**If SUCCESS ‚úÖ:**
```
- Frontend loads: YES
- Dark window: NO
- UI visible: YES
- Can interact: YES
```

**If FAILURE ‚ùå:**
```
- Output of: cat ~/v114-test.log | grep "Loading frontend"
- Output of: npx asar list app.asar | grep frontend
- Screenshot of dark window
```

---

**Last Updated**: November 10, 2025  
**Tag**: desktop-v1.1.4  
**Commit**: 6339b87  
**Both Fixes Verified**: ‚úÖ YES

